name: ğŸš€ Auto Publish Clean Architecture Template

on:
  push:
    branches:
      - main
  workflow_dispatch:  # permite rodar manualmente tambÃ©m

permissions:
  contents: write
  packages: write

jobs:
  publish:
    runs-on: ubuntu-latest

    steps:
      - name: ğŸ“¦ Checkout repository
        uses: actions/checkout@v4
        with:
          fetch-depth: 0  # necessÃ¡rio para ler tags anteriores

      - name: ğŸ§© Setup .NET
        uses: actions/setup-dotnet@v4
        with:
          dotnet-version: 9.0.x

      - name: ğŸ·ï¸ Detect next semantic version
        id: versioning
        run: |
          echo "ğŸ” Checking last Git tag..."
          last_tag=$(git describe --tags --abbrev=0 2>/dev/null || echo "v1.0.0")
          echo "Last tag: $last_tag"
          version=${last_tag#v}
          IFS='.' read -r major minor patch <<< "$version"
          patch=$((patch + 1))
          new_version="$major.$minor.$patch"
          echo "Next version: v$new_version"
          echo "VERSION=$new_version" >> $GITHUB_ENV

      - name: ğŸ—ï¸ Build
